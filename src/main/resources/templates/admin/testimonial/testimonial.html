<!DOCTYPE html>
<html lang="pt-br">
<head th:replace="~{/fragments/head('VB Admin - Depoimentos')}"></head>
<link rel="stylesheet" th:href="@{/css/testimonial.css}">
<link rel="stylesheet" th:href="@{/css/new-project.css}">
<link rel="stylesheet" th:href="@{/css/sidebar.css}">
<link rel="stylesheet" th:href="@{/css/topbar.css}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<body>
    <div class="container-admin">
        <div th:replace="~{/fragments/sidebar :: main_sidebar('testimonials')}"></div>
        <main class="main-content p-0">
            <nav th:replace="~{/fragments/topbar :: topbar}"></nav>
            <div class="content-wrapper">
              <h6>Bem-vindo de volta senhor!</h6>
                <div th:if="${#lists.isEmpty(testimonials)}">
                    <p>Nenhuma testemunha cadastrada!</p>
                    <a th:href="@{/admin/testimonials/new}" class="btn bg-orange"><i class="fa-solid fa-plus"></i> <strong>Adicionar depoimento</strong></a>
                </div>
                <div th:unless="${#lists.isEmpty(testimonials)}" class="my-4">
                    <div class="d-flex align-items-center justify-content-between">
                        <h4>Depoimentos</h4>
                        <a th:href="@{/admin/testimonials/new}" class="btn bg-orange"><i class="fa-solid fa-plus"></i> <strong>Adicionar depoimento</strong></a>
                    </div>
                    <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-4 mt-4">
                        <div class="col" th:each="testimonial : ${testimonials}">
                            <div class="card h-100 shadow-sm bg-dark text-white">
                                <div class="position-relative">
                                    <img th:src="${testimonial.avatar}" th:alt="${testimonial.name}" class="card-img-top" style="object-fit: cover; height:200px;">
                                    <div class="position-absolute top-0 end-0 m-2">
                                        <a th:href="@{'/admin/testimonials/edit/' + ${testimonial.id}}" class="btn btn-sm btn-primary me-1" title="Editar"><i class="fas fa-pencil-alt"></i></a>
                                        <a th:href="@{'/admin/testimonials/delete/' + ${testimonial.id}}" class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal" title="Apagar"><i class="fas fa-trash"></i></a>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <h5 class="card-title" th:text="${testimonial.name}"></h5>
                                    <h6 class="card-subtitle text-muted" th:text="${testimonial.role}"></h6>
                                    <p class="card-text mt-2" th:text="${testimonial.quote}"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <div th:if="${!#lists.isEmpty(notifications)}" th:each="notification : ${notifications}">
        <div th:replace="~{fragments/notifications :: notifications(${notification.type.name().toLowerCase()}, ${notification.message})}"></div>
    </div>
    <!-- Bootstrap Modal -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content bg-dark text-light">
          <div class="modal-header border-0">
            <h5 class="modal-title" id="deleteModalLabel">Confirmar exclus√£o</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
          </div>
          <div class="modal-body">
            Tem certeza que deseja apagar esta testemunha?
          </div>
          <div class="modal-footer border-0">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Sim, apagar</button>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    let deleteUrl = null;
    document.querySelectorAll('a[data-bs-target="#deleteModal"]').forEach(btn => {
      btn.addEventListener('click', function(e) {
        deleteUrl = this.getAttribute('href');
      });
    });
    document.getElementById('confirmDeleteBtn').onclick = function() {
      if (deleteUrl) window.location.href = deleteUrl;
    };
    </script>
</body>
</html>
